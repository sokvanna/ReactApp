<!DOCTYPE html>
<html>

<head>
	<title>SamePage</title>
	<meta charset="UTF-8">
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="styles.css" media="all" type="text/css" rel="stylesheet">
  <script src="https://fb.me/react-0.13.3.min.js"></script>
  <script src="https://fb.me/JSXTransformer-0.13.3.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
</head>

<body>
<div id="header">

</div>

<div id="main">

</div>

<div id="footer">

</div>
<script type="text/jsx">
 var BookTitle = [];
 
  $.ajax({
    url: 'https://en.wikipedia.org/w/api.php?action=query&list=random&format=json&rnnamespace=108&rnlimit=10',
    data: {
        format: 'json'
    },
    dataType: 'jsonp'
}).done( function ( data ) {
  for(var i = 0; i < data.query.random.length; i++){
   console.log(data.query.random[i]);
   var title = data.query.random[i].title.replace('Book:', '');
   var ID = data.query.random[i].id;

   BookTitle.push(title );
  
}

} );

setTimeout(function(){


var Library = React.createClass({
  handleClick: function(i) {
    var getTitle =  this.props.items[i];
console.log(getTitle);
var infoUrl = 'https://en.wikipedia.org/w/api.php?action=query&prop=categories|pageimages|pageterms&format=json&rawcontinue=&titles=Book:' + getTitle;
var imageUrl = 'https://en.wikipedia.org//w/api.php?action=query&titles=' +getTitle+ '&prop=pageimages';
// get category and description if available
$.ajax({
    url: infoUrl,
    data: {
        format: 'json'
    },
    dataType: 'jsonp'
}).done( function ( data ) {

    var firsty;
  
for (first in data.query.pages) {
firsty = first;
}
console.log(data.query.pages[firsty].categories[0].title);


} );

// get image url
$.ajax({
    url: imageUrl,
    data: {
        format: 'json'
    },
    dataType: 'jsonp'
}).done( function ( data ) {
  var firsty;
  
for (first in data.query.pages) {
firsty = first;
}
console.log(data.query.pages[firsty].thumbnail.source);

} );
  
  },

  render: function() {
    return (
      <div>
        {this.props.items.map(function(item, i) {
          return (
            <div className="bookTitle" onClick={this.handleClick.bind(this, i)} key={i}>{item}</div>
          );
        }, this)}
      </div>
    );
  }
});

React.render(
  <Library items={BookTitle} />, document.getElementById('main')
);

}, 3000);




</script>
</body>


</html>